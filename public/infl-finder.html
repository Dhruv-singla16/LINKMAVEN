<html>
    <head>
        <title>Document</title>
        <link rel="icon" href="pics/sitelogo.jpeg" type="image/icon type">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        <script src="server.js"></script>
        <script>
            $(document).ready(function(){
                let active=localStorage.getItem("activeuser");
                $("#dash").html("Welcome:"+active);
                if(active==null)
          {
            location.href="index.html";
          }
               
            })
        </script>
        <script>
            var module=angular.module("myModule",[]);
            var controller=module.controller("myController",function($scope,$http)
        {
            $scope.jsonAryFields;
            $scope.jsonAryCities;
            $scope.jsonAryCards;
            $scope.fillFields=function()
                {
                    let url="/fetch-all-fields";
                    $http.get(url).then(done,fail);
                    function done(response)
                    {
                        $scope.jsonAryFields=response.data;
                    }
                    function fail(err)
                    {
                        alert(err);
                    }
                    
                }
            $scope.doShowCities=function()
                {
                    
                    let content=$scope.selField;
                    let url="/fetch-city?content="+content;
                    $http.get(url).then(done,fail);

                    function done(response)
                    {
                        $scope.jsonAryCities=response.data;
                        alert(jsonAryCities);
                    }
                    function fail(err)
                    {
                        alert(err);
                    }
                }
                $scope.fillCards=function()
                {
                    let content=$scope.selField;
                    let city=$scope.selCity;
                    let url="/fetch-influencers-cards?content="+content+"&city="+city;
                    $http.get(url).then(done,fail);
                    function done(response)
                    {
                        $scope.jsonAryCards=response.data;
                    }
                    function fail(err)
                    {
                        alert(err);
                    }
                    
                }
                $scope.fillCardsbyName=function()
                {
                    let name=$scope.selName;
                    let url="/fetch-influencers-cardsbyname?name="+name;
                    $http.get(url).then(done,fail);
                    function done(response)
                    {
                        $scope.jsonAryCards=response.data;
                    }
                    function fail(err)
                    {
                        alert(err);
                    }
                    
                }
                $scope.showinfo=function(index)
                {
                    $scope.fullDetailObj=$scope.jsonAryCards[index];
                }
        })
        </script>
        <style>
            #outer-body{
                width: 1100px;
                height: 500px;
                border: 2px solid; 
            }
            #inner-body{
                width: 1000px;
                height: 340px;
                border: solid 2px;
                margin-top: 150px;
                overflow-y: scroll;
            }
        </style>
    </head>
    <body style="background-color: cornsilk;" ng-app="myModule" ng-controller="myController" ng-init="fillFields();">
      <nav class="navbar navbar-expand-lg sticky-top" style="background-color: palevioletred;">
        <div class="container-fluid" style=" height: 40px;">
          <a class="navbar-brand" href="#"><img src="images/Screenshot 2024-07-23 002733.jpg" alt="" height="50px" width="200px"></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
    
          
          </div>
        </div>
      </nav>
      <div style="width: inherit; height: 60px;margin-top: 10px; " ><center><h2  >Find Influencers</center><h3> <span style="position: absolute; right: 5px; top: 72px;" id="dash"></span></h3></h2>
  
      </div>
        <center> 
            <div id="outer-body">
                <div style="width: 350px;margin-left: 50px;float: left;">
                    <select class="form-select" aria-label="Default select example" ng-model="selField" ng-change="doShowCities();">
                        <option selected value="">Select Content</option>
                        <option ng-repeat="obj in jsonAryFields" value="{{obj.content}}">{{obj.content}}</option>
                      </select>
                </div>
                <div style="width: 350px;margin-left: 50px;float: left;margin-top: 10px;">
                    <select class="form-select" aria-label="Default select example" ng-model="selCity" >
                        <option selected value="">Select City</option>
                        <option ng-repeat="obj in jsonAryCities" value="{{obj.city}}">{{obj.city}}</option>
                      </select>
                </div>
                <div style="float: left;margin-top: 10px;margin-left: 20px;">
                    <button type="button" class="btn" style="background-color: palevioletred;color: cornsilk;" ng-click="fillCards();" ><b>Find Influencers</b></button>
                </div>
                <div class="mb-3" style="margin-top: 40px; width: 350px;margin-left: 50px;float: inline-start;float: left;">
                    <input type="Name" placeholder="Enter Name" ng-model="selName" class="form-control" >
                  </div>
                  <div style="float: left;margin-top: 40px;margin-left: 20px;">
                    <button type="button" class="btn" style="background-color: palevioletred;color: cornsilk;" ng-click="fillCardsbyName();" ><b>Find Influencer by Name</b></button>
                </div>

                <div id="inner-body">
                    <div>
                        <div class="col-md-3" ng-repeat="obj in jsonAryCards" style="float: left;margin-left: 20px;width: 250px;">
                            <div class="card mt-5" >
                              <center>  <img src="uploads/{{obj.ppic}}"   height="100px" width="100px"></center>
                                <div class="card-body">
                                    <h5 class="card-title"><b>Name:</b> {{obj.name}}</h5>
                                    <h5 class="card-title"><b>Gender:</b> {{obj.gender}}</h5>
                                    <h5 class="card-title"><b>Instagram:</b> {{obj.insta}}</h5>
                                    <button type="button" class="btn" style="background-color: palevioletred;color: cornsilk;"  data-bs-toggle="modal" data-bs-target="#staticBackdrop"  ng-click="showinfo($index);"><b>More Details</b></button>
                                    
                                </div>
                              </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content" style="background-color: cornsilk;">
                    <div class="modal-header" style="background-color: palevioletred; color: cornsilk;">
                      <h1 class="modal-title fs-5" id="staticBackdropLabel" ><b>Influencer's Details</b></h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div style="height: 210px;">
                      <div style="margin-left: 20px;float: left;">
                        <img src="uploads/{{fullDetailObj.ppic}}" height="200px" width="200px">
                      </div>
                      <div style="float: left;margin-left: 20px;">
                        <h3>{{fullDetailObj.name}}</h3>
                        <br><h5>{{fullDetailObj.content}}</h5><br>
                        <h5>DOB:</h5>{{fullDetailObj.dob}} <br>
                      </div> 
                    </div> <hr>
                    <div style="height: 150px;">
                      <div style="float: inline-start;margin-left: 20px;float: left;">
                        <b>Email ID:</b> <br> {{fullDetailObj.email}} <br>
                        <b>City:</b> <br> {{fullDetailObj.city}} <br> 
                        
                      </div>
                    </div> <hr>
                      <div style="float: inline-start;margin-left: 20px;float: left;">
                        <div style="float: left;">
                        <img src="images/insta-logo.jpeg" height="30px" width="30px">
                        {{fullDetailObj.insta}}
                        </div> 
                        
                        <div style="margin-left: 20px;float: left;">
                       <img src="images/utubee-logo.png" height="30px" width="30px">
                        {{fullDetailObj.youtube}}
                        </div> 
                      </div>
                      <div >

                      </div>                    
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn" style="background-color: palevioletred; color: cornsilk;" data-bs-dismiss="modal"><b>Close</b></button>
                    </div>
                  </div>
                </div>
              </div>

        </center>
       
        
    </body>
</html>